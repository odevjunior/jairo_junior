/**
 * Atropos 0.9.3
 * Touch-friendly 3D parallax hover effects
 * https://atroposjs.com
 *
 * Copyright 2021-2021 
 *
 * Released under the MIT License
 *
 * Released on: July 12, 2021
 */

function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var $=function(t,e){return t.querySelector(e)},$$=function(t,e){return t.querySelectorAll(e)},$setDuration=function(t,e){t.style.transitionDuration=e},$setTransform=function(t,e){t.style.transform=e},$setOpacity=function(t,e){t.style.opacity=e},$on=function(t,e,o,a){return t.addEventListener(e,o,a)},$off=function(t,e,o,a){return t.removeEventListener(e,o,a)},removeUndefinedProps=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(o){void 0!==t[o]&&(e[o]=t[o])})),e};function Atropos(t){void 0===t&&(t={});var e,o,a,r,n,s,i,p,c,d=t,u=d.el,f=d.eventsEl,l={__atropos__:!0,params:_extends({activeOffset:50,shadowOffset:50,shadowScale:1,durationEnter:300,durationLeave:600,rotateLock:!0,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},removeUndefinedProps(t||{})),destroyed:!1,isActive:!1},v=l.params,m=!0,y=!0,h=function(t){var e=t.rotateXPercentage,o=void 0===e?0:e,a=t.rotateYPercentage,r=void 0===a?0:a,n=t.duration,s=t.opacityOnly;$$(u,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(t){$setDuration(t,n);var e=function(t){if(t.dataset.atroposOpacity&&"string"==typeof t.dataset.atroposOpacity)return t.dataset.atroposOpacity.split(";").map((function(t){return parseFloat(t)}))}(t);if(0===o&&0===r)s||$setTransform(t,"translate3d(0, 0, 0)"),e&&$setOpacity(t,e[0]);else{var a=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(a)||s||$setTransform(t,"translate3d("+-r*-a+"%, "+o*-a+"%, 0)"),e){var i=e[0],p=e[1],c=Math.max(Math.abs(o),Math.abs(r));$setOpacity(t,i+(p-i)*c/100)}}}))},g=function(t){"pointerdown"===t.type&&"mouse"===t.pointerType||"pointerenter"===t.type&&"mouse"!==t.pointerType||("pointerdown"===t.type&&t.preventDefault(),u.classList.add("atropos-active"),$setDuration(e,"0ms"),r=void 0,n=void 0,m=!0,y=!0,$setTransform(o,"translate3d(0,0, "+v.activeOffset+"px)"),$setDuration(o,(v.rotateLock?v.durationEnter:0)+"ms"),i&&$setDuration(i,(v.rotateLock?v.durationEnter:0)+"ms"),l.isActive=!0,"function"==typeof v.onEnter&&v.onEnter())},x=function(t){if(v.rotate&&l.isActive){if("mouse"!==t.pointerType){if(!v.rotateTouch)return;t.preventDefault()}var o=t.clientX,a=t.clientY;s||(s=u.getBoundingClientRect());var i=s,c=i.top,d=i.left,f=i.width,$=i.height,g=f/2,x=$/2,L=o-d,M=a-c,T=v.rotateYMax*(L-g)/(f/2)*-1,_=v.rotateXMax*(M-x)/($/2);v.rotateLock&&(void 0===n&&(n=T,y=!0),void 0===r&&(r=_,m=!0),y&&(n<0&&(T<0&&(T=0),T>0&&(y=!1)),n>0&&(T>0&&(T=0),T<0&&(y=!1))),m&&(r<0&&(_<0&&(_=0),_>0&&(m=!1)),r>0&&(_>0&&(_=0),_<0&&(m=!1)))),_=Math.min(Math.max(-_,-v.rotateXMax),v.rotateXMax),v.rotateXInvert&&(_=-_),T=Math.min(Math.max(-T,-v.rotateYMax),v.rotateYMax),v.rotateYInvert&&(T=-T),$setTransform(e,"translate3d(0,0,0) rotateX("+_+"deg) rotateY("+T+"deg)");var O=_/v.rotateXMax*100,w=T/v.rotateYMax*100;p&&($setDuration(p,"0ms"),$setTransform(p,"translate3d("+.25*-w+"%, "+.25*O+"%, 0)"),p.style.opacity=Math.max(Math.abs(O),Math.abs(w))/100),h({rotateXPercentage:O,rotateYPercentage:w,duration:"0ms"}),"function"==typeof v.onRotate&&v.onRotate(_,T)}},L=function(t){s=void 0,l.isActive&&(t&&"pointerup"===t.type&&"mouse"===t.pointerType||t&&"pointerleave"===t.type&&"mouse"!==t.pointerType||(u.classList.remove("atropos-active"),$setTransform(o,"translate3d(0,0, 0px)"),$setDuration(o,v.durationLeave+"ms"),i&&$setDuration(i,v.durationLeave+"ms"),p&&($setDuration(p,v.durationLeave+"ms"),$setTransform(p,"translate3d(0, 0, 0)"),p.style.opacity=0),$setDuration(e,v.durationLeave+"ms"),$setTransform(e,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),h({duration:v.durationLeave+"ms"}),l.isActive=!1,"function"==typeof v.onRotate&&v.onRotate(0,0),"function"==typeof v.onLeave&&v.onLeave()))},M=function(t){var e=t.target;!u.contains(e)&&e!==u&&l.isActive&&L()};return l.destroy=function(){l.destroyed=!0,$off(document,"click",M),$off(f,"pointerdown",g),$off(f,"pointerenter",g),$off(f,"pointermove",x),$off(f,"pointerleave",L),$off(f,"pointerup",L),$off(f,"lostpointercapture",L),delete u.__atropos__},"string"==typeof u&&(u=$(document,u)),u&&(u.__atropos__||(void 0!==f?"string"==typeof f&&(f=$(document,f)):f=u,Object.assign(l,{el:u}),e=$(u,".atropos-rotate"),o=$(u,".atropos-scale"),a=$(u,".atropos-inner"),u.__atropos__=l)),u&&f&&(v.shadow&&((i=$(u,".atropos-shadow"))||((i=document.createElement("span")).classList.add("atropos-shadow"),c=!0),$setTransform(i,"translate3d(0,0,-"+v.shadowOffset+"px) scale("+v.shadowScale+")"),c&&e.appendChild(i)),v.highlight&&function(){var t;(p=$(u,".atropos-highlight"))||((p=document.createElement("span")).classList.add("atropos-highlight"),t=!0),$setTransform(p,"translate3d(0,0,0)"),t&&a.appendChild(p)}(),v.rotateTouch&&u.classList.add("atropos-rotate-touch"),$(u,"[data-atropos-opacity]")&&h({opacityOnly:!0}),$on(document,"click",M),$on(f,"pointerdown",g),$on(f,"pointerenter",g),$on(f,"pointermove",x),$on(f,"pointerleave",L),$on(f,"pointerup",L),$on(f,"lostpointercapture",L)),l}export default Atropos;export{Atropos};
//# sourceMappingURL=atropos.esm.browser.min.js.map